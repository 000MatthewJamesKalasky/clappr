{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dash-shaka-playback.external.min.js","webpack:///webpack/bootstrap fe7dd425d1805babfb2e","webpack:///./src/clappr-dash-shaka-playback.js","webpack:///external {\"amd\":\"clappr\",\"commonjs\":\"clappr\",\"commonjs2\":\"clappr\",\"root\":\"Clappr\"}","webpack:///external \"shaka\""],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE_1__","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","value","writable","setPrototypeOf","__proto__","_get","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","_createClass","defineProperties","target","props","length","descriptor","key","protoProps","staticProps","_clappr","_shakaPlayer","_shakaPlayer2","obj","default","DashShakaPlayback","_HTML5Video","_ref","_len","arguments","args","Array","_key","_this","apply","concat","_levels","_pendingAdaptationEvent","_isShakaReadyState","shaka","player","Player","version","_player","set","id","_this2","_currentLevelId","isAuto","trigger","Events","PLAYBACK_LEVEL_SWITCH_START","configure","abr","enabled","PLAYBACK_LEVEL_SWITCH_END","selectTrack","videoTracks","filter","t","resource","mimeType","polyfill","installAll","browserSupported","isBrowserSupported","resourceParts","split","match","indexOf","SHAKA_READY","_setup","isReady","once","play","_stopped","_src","el","src","PLAYBACK_READY","event","Log","error","highDefinition","_this3","clearInterval","sendStatsId","_sendStats","unload","then","catch","isLive","track","type","selectTextTrack","Error","selectVariantTrack","startsWith","_onAdaptation","isEnable","textTracks","_shakaTTVisible","from","kind","forEach","mode","_ccIsSetup","hasClosedCaptionsTracks","PLAYBACK_SUBTITLE_AVAILABLE","trackId","closedCaptionsTrackId","_this4","destroy","_destroy","_this5","_createPlayer","_options","shakaConfiguration","shakaOnBeforeLoad","load","_loaded","e","_setupError","addEventListener","_onError","bind","_onBuffering","buffering","PLAYBACK_BUFFERING","PLAYBACK_BUFFERFULL","_onShakaReady","_startToSendStats","_fillLevels","_checkForClosedCaptions","map","videoTrack","label","height","reverse","PLAYBACK_LEVELS_AVAILABLE","levels","_this6","intervalMs","shakaSendStatsInterval","setInterval","PLAYBACK_STATS_ADD","getStats","err","shakaError","videoError","_ref2","detail","category","code","severity","isCritical","util","Severity","CRITICAL","errorData","description","level","PlayerError","Levels","FATAL","WARN","raw","formattedError","createError","PLAYBACK_ERROR","activeVideo","active","_pendingAdaptationEvent_","debug","PLAYBACK_HIGHDEFINITIONUPDATE","PLAYBACK_BITRATE","bandwidth","width","getTextTracks","getVariantTracks","language","tracks","closedCaptionsTracks","showingTrack","find","warn","info","_enableShakaTextTrack","_ccTrackId","PLAYBACK_SUBTITLE_CHANGED","HTML5Video"],"mappings":"CAAA,SAAAA,EAAAC,GACA,gBAAAC,UAAA,gBAAAC,QACAA,OAAAD,QAAAD,EAAAG,QAAA,UAAAA,QAAA,UACA,kBAAAC,gBAAAC,IACAD,QAAA,kBAAAJ,GACA,gBAAAC,SACAA,QAAA,kBAAAD,EAAAG,QAAA,UAAAA,QAAA,UAEAJ,EAAA,kBAAAC,EAAAD,EAAA,OAAAA,EAAA,QACC,mBAAAO,WAAAC,KAAA,SAAAC,EAAAC,GACD,MCAgB,UAAUC,GCN1B,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAX,OAGA,IAAAC,GAAAW,EAAAD,IACAE,EAAAF,EACAG,GAAA,EACAd,WAUA,OANAS,GAAAE,GAAAI,KAAAd,EAAAD,QAAAC,IAAAD,QAAAU,GAGAT,EAAAa,GAAA,EAGAb,EAAAD,QAvBA,GAAAY,KA4DA,OAhCAF,GAAAM,EAAAP,EAGAC,EAAAO,EAAAL,EAGAF,EAAAQ,EAAA,SAAAlB,EAAAmB,EAAAC,GACAV,EAAAW,EAAArB,EAAAmB,IACAG,OAAAC,eAAAvB,EAAAmB,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAV,EAAAiB,EAAA,SAAA1B,GACA,GAAAmB,GAAAnB,KAAA2B,WACA,WAA2B,MAAA3B,GAAA,SAC3B,WAAiC,MAAAA,GAEjC,OADAS,GAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAQ,EAAAC,GAAsD,MAAAR,QAAAS,UAAAC,eAAAjB,KAAAc,EAAAC,IAGtDpB,EAAAuB,EAAA,QAGAvB,IAAAwB,EAAA,KDgBM,SAAUjC,EAAQD,EAASU,GAEjC,YAmBA,SAASyB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BlC,EAAMU,GAAQ,IAAKV,EAAQ,KAAM,IAAImC,gBAAe,4DAAgE,QAAOzB,GAAyB,gBAATA,IAAqC,kBAATA,GAA8BV,EAAPU,EAElO,QAAS0B,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIL,WAAU,iEAAoEK,GAAeD,GAASX,UAAYT,OAAOsB,OAAOD,GAAcA,EAAWZ,WAAac,aAAeC,MAAOJ,EAAUjB,YAAY,EAAOsB,UAAU,EAAMvB,cAAc,KAAemB,IAAYrB,OAAO0B,eAAiB1B,OAAO0B,eAAeN,EAAUC,GAAcD,EAASO,UAAYN,GApBjerB,OAAOC,eAAevB,EAAS,cAC7B8C,OAAO,GAGT,IAAII,GAAO,QAASxB,GAAIG,EAAQC,EAAUqB,GAA2B,OAAXtB,IAAiBA,EAASuB,SAASrB,UAAW,IAAIsB,GAAO/B,OAAOgC,yBAAyBzB,EAAQC,EAAW,QAAayB,KAATF,EAAoB,CAAE,GAAIG,GAASlC,OAAOmC,eAAe5B,EAAS,OAAe,QAAX2B,MAAmB,GAAkC9B,EAAI8B,EAAQ1B,EAAUqB,GAAoB,GAAI,SAAWE,GAAQ,MAAOA,GAAKP,KAAgB,IAAI1B,GAASiC,EAAK3B,GAAK,QAAe6B,KAAXnC,EAA4C,MAAOA,GAAOL,KAAKoC,IAExdO,EAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIhD,GAAI,EAAGA,EAAIgD,EAAMC,OAAQjD,IAAK,CAAE,GAAIkD,GAAaF,EAAMhD,EAAIkD,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWvC,cAAe,EAAU,SAAWuC,KAAYA,EAAWhB,UAAW,GAAMzB,OAAOC,eAAeqC,EAAQG,EAAWC,IAAKD,IAAiB,MAAO,UAAU1B,EAAa4B,EAAYC,GAAiJ,MAA9HD,IAAYN,EAAiBtB,EAAYN,UAAWkC,GAAiBC,GAAaP,EAAiBtB,EAAa6B,GAAqB7B,MExFhiB8B,EAAAzD,EAAA,GACA0D,EAAA1D,EAAA,GF6FI2D,EAEJ,SAAgCC,GAAO,MAAOA,IAAOA,EAAI1C,WAAa0C,GAAQC,QAASD,IAF5CF,GExFrCI,EFqGkB,SAAUC,GEnDhC,QAAAD,KAAsB,GAAAE,EAAAvC,GAAA7B,KAAAkE,EAAA,QAAAG,GAAAC,UAAAd,OAANe,EAAMC,MAAAH,GAAAI,EAAA,EAAAA,EAAAJ,EAAAI,IAANF,EAAME,GAAAH,UAAAG,EAAA,IAAAC,GAAAzC,EAAAjC,MAAAoE,EAAAF,EAAAvB,WAAA3B,OAAAmC,eAAAe,IAAAzD,KAAAkE,MAAAP,GAAApE,MAAA4E,OACXL,IADW,OAEpBG,GAAKG,WACLH,EAAKI,yBAA0B,EAC/BJ,EAAKK,oBAAqB,EAJNL,EFyftB,MArcAvC,GAAU+B,EAAmBC,GAE7Bf,EAAac,IACXR,IAAK,OACLtC,IAAK,WE3FL,MAAO,yBF+FPsC,IAAK,eACLtC,IAAK,WE5FL,MAAO4D,WAAMC,OAAOC,OAAOC,WFgG3BzB,IAAK,sBACLtC,IAAK,WE7FL,MAAOpB,MAAKoF,WFiGZ1B,IAAK,SACLtC,IAAK,WE9FL,MAAOpB,MAAK6E,WFkGZnB,IAAK,eACL2B,IAAK,SEhGWC,GAAI,GAAAC,GAAAvF,IACpBA,MAAKwF,gBAAkBF,CACvB,IAAIG,IAlCmB,IAkCVzF,KAAKwF,eAElBxF,MAAK0F,QAAQC,SAAOC,6BACfH,GAMHzF,KAAKoF,QAAQS,WAAWC,KAAMC,SAAS,KACvC/F,KAAK0F,QAAQC,SAAOK,6BANpBhG,KAAKoF,QAAQS,WAAWC,KAAMC,SAAS,KACvC/F,KAAK8E,yBAA0B,EAC/B9E,KAAKiG,YAAYjG,KAAKkG,YAAYC,OAAO,SAACC,GAAD,MAAOA,GAAEd,KAAOC,EAAKC,kBAAiB,MF0GjFpE,IAAK,WEjGL,MAAOpB,MAAKwF,kBAjDW,OFsJvB9B,IAAK,UACLlB,MAAO,SE9IO6D,GAAyB,GAAfC,GAAehC,UAAAd,OAAA,OAAAP,KAAAqB,UAAA,GAAAA,UAAA,GAAJ,EACnCU,WAAMuB,SAASC,YACf,IAAIC,GAAmBzB,UAAME,OAAOwB,qBAChCC,EAAgBN,EAASO,MAAM,KAAK,GAAGC,MAAM,gBACjD,OAAOJ,KAA2C,QAArBE,EAAc,IAAiBL,EAASQ,QAAQ,yBAA2B,MFmJxGpD,IAAK,SACLtC,IAAK,WE7JL,OACE2F,YAAa,mBFoLjB3D,EAAac,IACXR,IAAK,OACLlB,MAAO,WE3HP,GAJKxC,KAAKoF,SACRpF,KAAKgH,UAGFhH,KAAKiH,QAER,WADAjH,MAAKkH,KAAKhD,EAAkByB,OAAOoB,YAAa/G,KAAKmH,KAIvDnH,MAAKoH,UAAW,EAChBpH,KAAKqH,KAAOrH,KAAKsH,GAAGC,IACpB3E,EAAAsB,EAAAzC,UAAAkB,WAAA3B,OAAAmC,eAAAe,EAAAzC,WAAA,OAAAzB,MAAAS,KAAAT,SFsIA0D,IAAK,YACLlB,MAAO,eAKPkB,IAAK,SACLlB,MAAO,eAIPkB,IAAK,gBACLlB,MAAO,WEtIPxC,KAAK+E,oBAAqB,EAC1B/E,KAAK0F,QAAQxB,EAAkByB,OAAOoB,aACtC/G,KAAK0F,QAAQC,SAAO6B,eAAgBxH,KAAKa,SF0IzC6C,IAAK,QAILlB,MAAO,SEtIFiF,GACLC,MAAIC,MAAM,uCAAwCF,EAAOzH,KAAKsH,GAAGK,UFyIjEjE,IAAK,wBACLlB,MAAO,WEtIP,QAASxC,KAAK4H,kBF0IdlE,IAAK,OACLlB,MAAO,WExID,GAAAqF,GAAA7H,IACN8H,eAAc9H,KAAK+H,aACnB/H,KAAKoH,UAAW,EAEZpH,KAAKoF,SACPpF,KAAKgI,aAELhI,KAAKoF,QAAQ6C,SAASC,KAAK,WACzBtF,EAAAsB,EAAAzC,UAAAkB,WAAA3B,OAAAmC,eAAAe,EAAAzC,WAAA,OAAAoG,GAAApH,KAAAoH,GACAA,EAAKzC,QAAU,KACfyC,EAAK9C,oBAAqB,IACzBoD,MAAM,WACPT,MAAIC,MAAM,kCAGZ/E,EAAAsB,EAAAzC,UAAAkB,WAAA3B,OAAAmC,eAAAe,EAAAzC,WAAA,OAAAzB,MAAAS,KAAAT,SF8IF0D,IAAK,kBACLlB,MAAO,WE9HP,OAAQxC,KAAKiH,SAAWjH,KAAKoF,QAAQgD,SAAW,OAAS,QAAU,MFkInE1E,IAAK,cACLlB,MAAO,SEhII6F,GACX,GAAmB,SAAfA,EAAMC,KACNtI,KAAKoF,QAAQmD,gBAAgBF,OAC1B,IAAmB,YAAfA,EAAMC,KAQb,KAAM,IAAIE,OAAM,wBAAyBH,EAAMC,KAP/CtI,MAAKoF,QAAQqD,mBAAmBJ,GAC5BA,EAAM/B,SAASoC,WAAW,WAG1B1I,KAAK2I,oBF4IbjF,IAAK,wBACLlB,MAAO,SE7EaoG,GAGf5I,KAAKsH,GAAGuB,aAIb7I,KAAK8I,gBAAkBF,EAEvBpE,MAAMuE,KAAK/I,KAAKsH,GAAGuB,YAChB1C,OAAO,SAAAkC,GAAA,MAAwB,cAAfA,EAAMW,OACtBC,QAAQ,SAAAZ,GAAA,MAASA,GAAMa,MAAoB,IAAbN,EAAoB,UAAY,eFkFjElF,IAAK,0BACLlB,MAAO,WE/EP,IAAIxC,KAAKmJ,WAAT,CAIA,GAAInJ,KAAKoJ,wBAAyB,CAChCpJ,KAAK0F,QAAQC,SAAO0D,4BACpB,IAAMC,GAAUtJ,KAAKuJ,qBACrBvJ,MAAKuJ,sBAAwBD,EAE/BtJ,KAAKmJ,YAAa,MFmFlBzF,IAAK,UACLlB,MAAO,WEjFE,GAAAgH,GAAAxJ,IACT8H,eAAc9H,KAAK+H,aAEf/H,KAAKoF,QACPpF,KAAKoF,QAAQqE,UACVvB,KAAK,iBAAMsB,GAAKE,aAChBvB,MAAM,WACLqB,EAAKE,WACLhC,MAAIC,MAAM,kCAGd3H,KAAK0J,WAGP9G,EAAAsB,EAAAzC,UAAAkB,WAAA3B,OAAAmC,eAAAe,EAAAzC,WAAA,UAAAzB,MAAAS,KAAAT,SFsFA0D,IAAK,SACLlB,MAAO,WEpFC,GAAAmH,GAAA3J,IACRA,MAAK+E,oBAAqB,EAC1B/E,KAAKmJ,YAAa,EAClBnJ,KAAKoF,QAAUpF,KAAK4J,gBACpB5J,KAAK6J,SAASC,oBAAsB9J,KAAKoF,QAAQS,UAAU7F,KAAK6J,SAASC,oBACzE9J,KAAK6J,SAASE,mBAAqB/J,KAAK6J,SAASE,kBAAkB/J,KAAKoF,SAErDpF,KAAKoF,QAAQ4E,KAAKhK,KAAK6J,SAAStC,KACtCW,KAAK,iBAAMyB,GAAKM,YAC1B9B,MAAM,SAAC+B,GAAD,MAAOP,GAAKQ,YAAYD,QF4FjCxG,IAAK,gBACLlB,MAAO,WEzFP,GAAIyC,GAAS,GAAID,WAAME,OAAOlF,KAAKsH,GAInC,OAHArC,GAAOmF,iBAAiB,QAASpK,KAAKqK,SAASC,KAAKtK,OACpDiF,EAAOmF,iBAAiB,aAAcpK,KAAK2I,cAAc2B,KAAKtK,OAC9DiF,EAAOmF,iBAAiB,YAAapK,KAAKuK,aAAaD,KAAKtK,OACrDiF,KF6FPvB,IAAK,eACLlB,MAAO,SE3FK0H,GACZ,IAAIlK,KAAKoH,SAAT,CACA,GAAIK,GAAQyC,EAAEM,UAAY7E,SAAO8E,mBAAqB9E,SAAO+E,mBAC7D1K,MAAK0F,QAAQ+B,OF8Fb/D,IAAK,UACLlB,MAAO,WE3FPxC,KAAK2K,gBACL3K,KAAK4K,oBACL5K,KAAK6K,cACL7K,KAAK8K,6BF+FLpH,IAAK,cACLlB,MAAO,WE5FqB,IAAxBxC,KAAK6E,QAAQrB,SACfxD,KAAK6E,QAAU7E,KAAKkG,YAAY6E,IAAI,SAACC,GAAiB,OAAQ1F,GAAI0F,EAAW1F,GAAI2F,MAAUD,EAAWE,OAArB,OAAmCC,UACpHnL,KAAK0F,QAAQC,SAAOyF,0BAA2BpL,KAAKqL,YFmGtD3H,IAAK,oBACLlB,MAAO,WEhGY,GAAA8I,GAAAtL,KACbuL,EAAavL,KAAK6J,SAAS2B,wBAtSN,GAuS3BxL,MAAK+H,YAAc0D,YAAY,iBAAMH,GAAKtD,cAAcuD,MFuGxD7H,IAAK,aACLlB,MAAO,WEpGPxC,KAAK0F,QAAQC,SAAO+F,mBAAoB1L,KAAKoF,QAAQuG,eFwGrDjI,IAAK,cACLlB,MAAO,SEtGIoJ,GACX5L,KAAKqK,SAASuB,MFyGdlI,IAAK,WACLlB,MAAO,SEvGCoJ,GACR,GAAMjE,IACJkE,WAAYD,EACZE,WAAY9L,KAAKsH,GAAGK,OAHToE,EAMsBpE,EAAMkE,WAAWG,QAAUrE,EAAMkE,WAA9DI,EANOF,EAMPE,SAAUC,EANHH,EAMGG,KAAMC,EANTJ,EAMSI,QAEtB,IAAIxE,EAAMmE,aAAeI,IAASD,EAAU,MAAArJ,GAAAsB,EAAAzC,UAAAkB,WAAA3B,OAAAmC,eAAAe,EAAAzC,WAAA,WAAAzB,MAAAS,KAAAT,KAE5C,IAAMoM,GAAaD,IAAanH,UAAMqH,KAAK7D,MAAM8D,SAASC,SACpDC,GACJN,KAASD,EAAT,IAAqBC,EACrBO,yBAA0BR,EAA1B,WAA6CC,EAA7C,eAAgEC,EAChEO,MAAON,EAAaO,cAAYC,OAAOC,MAAQF,cAAYC,OAAOE,KAClEC,IAAKnB,GAEDoB,EAAiBhN,KAAKiN,YAAYT,EACxC9E,OAAIC,MAAM,qBAAsBqF,GAChChN,KAAK0F,QAAQC,SAAOuH,eAAgBF,MF6GpCtJ,IAAK,gBACLlB,MAAO,WEzGP,GAAI2K,GAAcnN,KAAKkG,YAAYC,OAAO,SAACC,GAAD,OAAoB,IAAbA,EAAEgH,SAAiB,EAEpEpN,MAAK6K,cAIL7K,KAAKgI,aAEDhI,KAAKqN,2BACPrN,KAAK0F,QAAQC,SAAOK,2BACpBhG,KAAK8E,yBAA0B,GAGjC4C,MAAI4F,MAAM,8BAA+BH,GACzCnN,KAAK4H,eAAkBuF,EAAYjC,QAAU,IAC7ClL,KAAK0F,QAAQC,SAAO4H,8BAA+BvN,KAAK4H,gBACxD5H,KAAK0F,QAAQC,SAAO6H,kBAClBC,UAAWN,EAAYM,UACvBC,MAAOP,EAAYO,MACnBxC,OAAQiC,EAAYjC,OACpBwB,MAAOS,EAAY7H,QFgHrB5B,IAAK,WACLlB,MAAO,WE5GPxC,KAAK+E,oBAAqB,EAC1B2C,MAAI4F,MAAM,0BFgHV5J,IAAK,UACLtC,IAAK,WE3XL,MAAOpB,MAAK+E,sBF+XZrB,IAAK,aACLtC,IAAK,WEhWL,MAAOpB,MAAKiH,SAAWjH,KAAKoF,QAAQuI,mBFoWpCjK,IAAK,cACLtC,IAAK,WEjWL,MAAOpB,MAAKiH,SAAWjH,KAAKoF,QAAQwI,mBAAmBzH,OAAO,SAACC,GAAD,MAAOA,GAAEE,SAASoC,WAAW,eFuW3FhF,IAAK,cACLtC,IAAK,WEpWL,MAAOpB,MAAKiH,SAAWjH,KAAKoF,QAAQwI,mBAAmBzH,OAAO,SAACC,GAAD,MAAOA,GAAEE,SAASoC,WAAW,eF0W3FhF,IAAK,uBACLtC,IAAK,WEjVL,GAAIkE,GAAK,EACLgE,EAAU,WAAQ,MAAOhE,KAG7B,QAFatF,KAAK6I,gBAGf1C,OAAO,SAAAkC,GAAA,MAAwB,aAAfA,EAAMW,OACtB+B,IAAI,SAAA1C,GAAW,OAAQ/C,GAAIgE,IAAWzI,KAAMwH,EAAM4C,OAAS5C,EAAMwF,SAAUxF,MAAOA,QF8VrF3E,IAAK,wBACLtC,IAAK,WExVL,MAAAwB,GAAAsB,EAAAzC,UAAAkB,WAAA3B,OAAAmC,eAAAe,EAAAzC,WAAA,wBAAAzB,OFgWAqF,IAAK,SE1VmBiE,GACxB,GAAKtJ,KAAKoF,QAAV,CAIA,GAAI0I,GAAS9N,KAAK+N,qBACdC,QAGJ,KAAiB,IAAb1E,EAAgB,CAElB,KADA0E,EAAeF,EAAOG,KAAK,SAAA5F,GAAA,MAASA,GAAM/C,KAAOgE,KAG/C,WADA5B,OAAIwG,KAAJ,aAAsB5E,EAAtB,cAGF,IAAItJ,KAAK8I,kBAAiD,IAA9BkF,EAAa3F,MAAM+E,OAE7C,WADA1F,OAAIyG,KAAJ,aAAsB7E,EAAtB,qBAKA0E,GACFhO,KAAKoF,QAAQmD,gBAAgByF,EAAa3F,OAC1CrI,KAAKoO,uBAAsB,IAE3BpO,KAAKoO,uBAAsB,GAG7BpO,KAAKqO,WAAa/E,EAClBtJ,KAAK0F,QAAQC,SAAO2I,2BAClBhJ,GAAIgE,SFiWDpF,GE3iBuBqK,aF8iBhC7O,GAAQuE,QEzMOC,EF0MfvE,EAAOD,QAAUA,EAAiB,SAI5B,SAAUC,EAAQD,GGzjBxBC,EAAAD,QAAAO,GH+jBM,SAAUN,EAAQD,GI/jBxBC,EAAAD,QAAAQ","file":"dash-shaka-playback.external.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"clappr\"), require(\"shaka\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"clappr\", \"shaka\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DashShakaPlayback\"] = factory(require(\"clappr\"), require(\"shaka\"));\n\telse\n\t\troot[\"DashShakaPlayback\"] = factory(root[\"Clappr\"], root[\"shaka\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"clappr\"), require(\"shaka\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"clappr\", \"shaka\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"DashShakaPlayback\"] = factory(require(\"clappr\"), require(\"shaka\"));\n\telse\n\t\troot[\"DashShakaPlayback\"] = factory(root[\"Clappr\"], root[\"shaka\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _clappr = __webpack_require__(1);\n\nvar _shakaPlayer = __webpack_require__(2);\n\nvar _shakaPlayer2 = _interopRequireDefault(_shakaPlayer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar SEND_STATS_INTERVAL_MS = 30 * 1e3;\nvar DEFAULT_LEVEL_AUTO = -1;\n\nvar DashShakaPlayback = function (_HTML5Video) {\n  _inherits(DashShakaPlayback, _HTML5Video);\n\n  _createClass(DashShakaPlayback, [{\n    key: 'name',\n    get: function get() {\n      return 'dash_shaka_playback';\n    }\n  }, {\n    key: 'shakaVersion',\n    get: function get() {\n      return _shakaPlayer2.default.player.Player.version;\n    }\n  }, {\n    key: 'shakaPlayerInstance',\n    get: function get() {\n      return this._player;\n    }\n  }, {\n    key: 'levels',\n    get: function get() {\n      return this._levels;\n    }\n  }, {\n    key: 'currentLevel',\n    set: function set(id) {\n      var _this2 = this;\n\n      this._currentLevelId = id;\n      var isAuto = this._currentLevelId === DEFAULT_LEVEL_AUTO;\n\n      this.trigger(_clappr.Events.PLAYBACK_LEVEL_SWITCH_START);\n      if (!isAuto) {\n        this._player.configure({ abr: { enabled: false } });\n        this._pendingAdaptationEvent = true;\n        this.selectTrack(this.videoTracks.filter(function (t) {\n          return t.id === _this2._currentLevelId;\n        })[0]);\n      } else {\n        this._player.configure({ abr: { enabled: true } });\n        this.trigger(_clappr.Events.PLAYBACK_LEVEL_SWITCH_END);\n      }\n    },\n    get: function get() {\n      return this._currentLevelId || DEFAULT_LEVEL_AUTO;\n    }\n  }], [{\n    key: 'canPlay',\n    value: function canPlay(resource) {\n      var mimeType = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n      _shakaPlayer2.default.polyfill.installAll();\n      var browserSupported = _shakaPlayer2.default.Player.isBrowserSupported();\n      var resourceParts = resource.split('?')[0].match(/.*\\.(.*)$/) || [];\n      return browserSupported && (resourceParts[1] === 'mpd' || mimeType.indexOf('application/dash+xml') > -1);\n    }\n  }, {\n    key: 'Events',\n    get: function get() {\n      return {\n        SHAKA_READY: 'shaka:ready'\n      };\n    }\n  }]);\n\n  function DashShakaPlayback() {\n    var _ref;\n\n    _classCallCheck(this, DashShakaPlayback);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var _this = _possibleConstructorReturn(this, (_ref = DashShakaPlayback.__proto__ || Object.getPrototypeOf(DashShakaPlayback)).call.apply(_ref, [this].concat(args)));\n\n    _this._levels = [];\n    _this._pendingAdaptationEvent = false;\n    _this._isShakaReadyState = false;\n    return _this;\n  }\n\n  _createClass(DashShakaPlayback, [{\n    key: 'play',\n    value: function play() {\n      if (!this._player) {\n        this._setup();\n      }\n\n      if (!this.isReady) {\n        this.once(DashShakaPlayback.Events.SHAKA_READY, this.play);\n        return;\n      }\n\n      this._stopped = false;\n      this._src = this.el.src;\n      _get(DashShakaPlayback.prototype.__proto__ || Object.getPrototypeOf(DashShakaPlayback.prototype), 'play', this).call(this);\n    }\n\n    // skipping HTML5Video `_setupSrc` (on tag video)\n\n  }, {\n    key: '_setupSrc',\n    value: function _setupSrc() {}\n\n    // skipping ready event on video tag in favor of ready on shaka\n\n  }, {\n    key: '_ready',\n    value: function _ready() {\n      // override with no-op\n    }\n  }, {\n    key: '_onShakaReady',\n    value: function _onShakaReady() {\n      this._isShakaReadyState = true;\n      this.trigger(DashShakaPlayback.Events.SHAKA_READY);\n      this.trigger(_clappr.Events.PLAYBACK_READY, this.name);\n    }\n  }, {\n    key: 'error',\n\n\n    // skipping error handling on video tag in favor of error on shaka\n    value: function error(event) {\n      _clappr.Log.error('an error was raised by the video tag', event, this.el.error);\n    }\n  }, {\n    key: 'isHighDefinitionInUse',\n    value: function isHighDefinitionInUse() {\n      return !!this.highDefinition;\n    }\n  }, {\n    key: 'stop',\n    value: function stop() {\n      var _this3 = this;\n\n      clearInterval(this.sendStatsId);\n      this._stopped = true;\n\n      if (this._player) {\n        this._sendStats();\n\n        this._player.unload().then(function () {\n          _get(DashShakaPlayback.prototype.__proto__ || Object.getPrototypeOf(DashShakaPlayback.prototype), 'stop', _this3).call(_this3);\n          _this3._player = null;\n          _this3._isShakaReadyState = false;\n        }).catch(function () {\n          _clappr.Log.error('shaka could not be unloaded');\n        });\n      } else {\n        _get(DashShakaPlayback.prototype.__proto__ || Object.getPrototypeOf(DashShakaPlayback.prototype), 'stop', this).call(this);\n      }\n    }\n  }, {\n    key: 'getPlaybackType',\n    value: function getPlaybackType() {\n      return (this.isReady && this._player.isLive() ? 'live' : 'vod') || '';\n    }\n  }, {\n    key: 'selectTrack',\n    value: function selectTrack(track) {\n      if (track.type === 'text') {\n        this._player.selectTextTrack(track);\n      } else if (track.type === 'variant') {\n        this._player.selectVariantTrack(track);\n        if (track.mimeType.startsWith('video/')) {\n          // we trigger the adaptation event here\n          // because Shaka doesn't trigger its event on \"manual\" selection.\n          this._onAdaptation();\n        }\n      } else {\n        throw new Error('Unhandled track type:', track.type);\n      }\n    }\n\n    /**\n     * @override\n     */\n\n  }, {\n    key: '_enableShakaTextTrack',\n    value: function _enableShakaTextTrack(isEnable) {\n      // Shaka player use only one TextTrack object with video element to handle all text tracks\n      // It must be enabled or disabled in addition to call selectTextTrack()\n      if (!this.el.textTracks) {\n        return;\n      }\n\n      this._shakaTTVisible = isEnable;\n\n      Array.from(this.el.textTracks).filter(function (track) {\n        return track.kind === 'subtitles';\n      }).forEach(function (track) {\n        return track.mode = isEnable === true ? 'showing' : 'hidden';\n      });\n    }\n  }, {\n    key: '_checkForClosedCaptions',\n    value: function _checkForClosedCaptions() {\n      if (this._ccIsSetup) {\n        return;\n      }\n\n      if (this.hasClosedCaptionsTracks) {\n        this.trigger(_clappr.Events.PLAYBACK_SUBTITLE_AVAILABLE);\n        var trackId = this.closedCaptionsTrackId;\n        this.closedCaptionsTrackId = trackId;\n      }\n      this._ccIsSetup = true;\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      var _this4 = this;\n\n      clearInterval(this.sendStatsId);\n\n      if (this._player) {\n        this._player.destroy().then(function () {\n          return _this4._destroy();\n        }).catch(function () {\n          _this4._destroy();\n          _clappr.Log.error('shaka could not be destroyed');\n        });\n      } else {\n        this._destroy();\n      }\n\n      _get(DashShakaPlayback.prototype.__proto__ || Object.getPrototypeOf(DashShakaPlayback.prototype), 'destroy', this).call(this);\n    }\n  }, {\n    key: '_setup',\n    value: function _setup() {\n      var _this5 = this;\n\n      this._isShakaReadyState = false;\n      this._ccIsSetup = false;\n      this._player = this._createPlayer();\n      this._options.shakaConfiguration && this._player.configure(this._options.shakaConfiguration);\n      this._options.shakaOnBeforeLoad && this._options.shakaOnBeforeLoad(this._player);\n\n      var playerLoaded = this._player.load(this._options.src);\n      playerLoaded.then(function () {\n        return _this5._loaded();\n      }).catch(function (e) {\n        return _this5._setupError(e);\n      });\n    }\n  }, {\n    key: '_createPlayer',\n    value: function _createPlayer() {\n      var player = new _shakaPlayer2.default.Player(this.el);\n      player.addEventListener('error', this._onError.bind(this));\n      player.addEventListener('adaptation', this._onAdaptation.bind(this));\n      player.addEventListener('buffering', this._onBuffering.bind(this));\n      return player;\n    }\n  }, {\n    key: '_onBuffering',\n    value: function _onBuffering(e) {\n      if (this._stopped) return;\n      var event = e.buffering ? _clappr.Events.PLAYBACK_BUFFERING : _clappr.Events.PLAYBACK_BUFFERFULL;\n      this.trigger(event);\n    }\n  }, {\n    key: '_loaded',\n    value: function _loaded() {\n      this._onShakaReady();\n      this._startToSendStats();\n      this._fillLevels();\n      this._checkForClosedCaptions();\n    }\n  }, {\n    key: '_fillLevels',\n    value: function _fillLevels() {\n      if (this._levels.length === 0) {\n        this._levels = this.videoTracks.map(function (videoTrack) {\n          return { id: videoTrack.id, label: videoTrack.height + 'p' };\n        }).reverse();\n        this.trigger(_clappr.Events.PLAYBACK_LEVELS_AVAILABLE, this.levels);\n      }\n    }\n  }, {\n    key: '_startToSendStats',\n    value: function _startToSendStats() {\n      var _this6 = this;\n\n      var intervalMs = this._options.shakaSendStatsInterval || SEND_STATS_INTERVAL_MS;\n      this.sendStatsId = setInterval(function () {\n        return _this6._sendStats();\n      }, intervalMs);\n    }\n  }, {\n    key: '_sendStats',\n    value: function _sendStats() {\n      this.trigger(_clappr.Events.PLAYBACK_STATS_ADD, this._player.getStats());\n    }\n  }, {\n    key: '_setupError',\n    value: function _setupError(err) {\n      this._onError(err);\n    }\n  }, {\n    key: '_onError',\n    value: function _onError(err) {\n      var error = {\n        shakaError: err,\n        videoError: this.el.error\n      };\n\n      var _ref2 = error.shakaError.detail || error.shakaError,\n          category = _ref2.category,\n          code = _ref2.code,\n          severity = _ref2.severity;\n\n      if (error.videoError || !code && !category) return _get(DashShakaPlayback.prototype.__proto__ || Object.getPrototypeOf(DashShakaPlayback.prototype), '_onError', this).call(this);\n\n      var isCritical = severity === _shakaPlayer2.default.util.Error.Severity.CRITICAL;\n      var errorData = {\n        code: category + '_' + code,\n        description: 'Category: ' + category + ', code: ' + code + ', severity: ' + severity,\n        level: isCritical ? _clappr.PlayerError.Levels.FATAL : _clappr.PlayerError.Levels.WARN,\n        raw: err\n      };\n      var formattedError = this.createError(errorData);\n      _clappr.Log.error('Shaka error event:', formattedError);\n      this.trigger(_clappr.Events.PLAYBACK_ERROR, formattedError);\n    }\n  }, {\n    key: '_onAdaptation',\n    value: function _onAdaptation() {\n      var activeVideo = this.videoTracks.filter(function (t) {\n        return t.active === true;\n      })[0];\n\n      this._fillLevels();\n\n      // update stats that may have changed before we trigger event\n      // so that user can rely on stats data when handling event\n      this._sendStats();\n\n      if (this._pendingAdaptationEvent_) {\n        this.trigger(_clappr.Events.PLAYBACK_LEVEL_SWITCH_END);\n        this._pendingAdaptationEvent = false;\n      }\n\n      _clappr.Log.debug('an adaptation has happened:', activeVideo);\n      this.highDefinition = activeVideo.height >= 720;\n      this.trigger(_clappr.Events.PLAYBACK_HIGHDEFINITIONUPDATE, this.highDefinition);\n      this.trigger(_clappr.Events.PLAYBACK_BITRATE, {\n        bandwidth: activeVideo.bandwidth,\n        width: activeVideo.width,\n        height: activeVideo.height,\n        level: activeVideo.id\n      });\n    }\n  }, {\n    key: '_destroy',\n    value: function _destroy() {\n      this._isShakaReadyState = false;\n      _clappr.Log.debug('shaka was destroyed');\n    }\n  }, {\n    key: 'isReady',\n    get: function get() {\n      return this._isShakaReadyState;\n    }\n  }, {\n    key: 'textTracks',\n    get: function get() {\n      return this.isReady && this._player.getTextTracks();\n    }\n  }, {\n    key: 'audioTracks',\n    get: function get() {\n      return this.isReady && this._player.getVariantTracks().filter(function (t) {\n        return t.mimeType.startsWith('audio/');\n      });\n    }\n  }, {\n    key: 'videoTracks',\n    get: function get() {\n      return this.isReady && this._player.getVariantTracks().filter(function (t) {\n        return t.mimeType.startsWith('video/');\n      });\n    }\n  }, {\n    key: 'closedCaptionsTracks',\n    get: function get() {\n      var id = 0;\n      var trackId = function trackId() {\n        return id++;\n      };\n      var tracks = this.textTracks || [];\n\n      return tracks.filter(function (track) {\n        return track.kind === 'subtitle';\n      }).map(function (track) {\n        return { id: trackId(), name: track.label || track.language, track: track };\n      });\n    }\n\n    /**\n     * @override\n     */\n\n  }, {\n    key: 'closedCaptionsTrackId',\n    get: function get() {\n      return _get(DashShakaPlayback.prototype.__proto__ || Object.getPrototypeOf(DashShakaPlayback.prototype), 'closedCaptionsTrackId', this);\n    }\n\n    /**\n     * @override\n     */\n    ,\n    set: function set(trackId) {\n      if (!this._player) {\n        return;\n      }\n\n      var tracks = this.closedCaptionsTracks;\n      var showingTrack = void 0;\n\n      // Note: -1 is for hide all tracks\n      if (trackId !== -1) {\n        showingTrack = tracks.find(function (track) {\n          return track.id === trackId;\n        });\n        if (!showingTrack) {\n          _clappr.Log.warn('Track id \"' + trackId + '\" not found');\n          return;\n        }\n        if (this._shakaTTVisible && showingTrack.track.active === true) {\n          _clappr.Log.info('Track id \"' + trackId + '\" already showing');\n          return;\n        }\n      }\n\n      if (showingTrack) {\n        this._player.selectTextTrack(showingTrack.track);\n        this._enableShakaTextTrack(true);\n      } else {\n        this._enableShakaTextTrack(false);\n      }\n\n      this._ccTrackId = trackId;\n      this.trigger(_clappr.Events.PLAYBACK_SUBTITLE_CHANGED, {\n        id: trackId\n      });\n    }\n  }]);\n\n  return DashShakaPlayback;\n}(_clappr.HTML5Video);\n\nexports.default = DashShakaPlayback;\nmodule.exports = exports['default'];\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// dash-shaka-playback.external.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fe7dd425d1805babfb2e","import {HTML5Video, Log, Events, PlayerError} from 'clappr'\nimport shaka from 'shaka-player'\n\nconst SEND_STATS_INTERVAL_MS = 30 * 1e3\nconst DEFAULT_LEVEL_AUTO = -1\n\nclass DashShakaPlayback extends HTML5Video {\n  static get Events () {\n    return {\n      SHAKA_READY: 'shaka:ready'\n    }\n  }\n\n  static canPlay (resource, mimeType = '') {\n    shaka.polyfill.installAll()\n    let browserSupported = shaka.Player.isBrowserSupported()\n    let resourceParts = resource.split('?')[0].match(/.*\\.(.*)$/) || []\n    return browserSupported && ((resourceParts[1] === 'mpd') || mimeType.indexOf('application/dash+xml') > -1)\n  }\n\n  get name () {\n    return 'dash_shaka_playback'\n  }\n\n  get shakaVersion () {\n    return shaka.player.Player.version\n  }\n\n  get shakaPlayerInstance () {\n    return this._player\n  }\n\n  get levels () {\n    return this._levels\n  }\n\n  set currentLevel (id) {\n    this._currentLevelId = id\n    let isAuto = this._currentLevelId === DEFAULT_LEVEL_AUTO\n\n    this.trigger(Events.PLAYBACK_LEVEL_SWITCH_START)\n    if (!isAuto) {\n      this._player.configure({abr: {enabled: false}})\n      this._pendingAdaptationEvent = true\n      this.selectTrack(this.videoTracks.filter((t) => t.id === this._currentLevelId)[0])\n    }\n    else {\n      this._player.configure({abr: {enabled: true}})\n      this.trigger(Events.PLAYBACK_LEVEL_SWITCH_END)\n    }\n  }\n\n  get currentLevel () {\n    return this._currentLevelId || DEFAULT_LEVEL_AUTO\n  }\n\n  constructor (...args) {\n    super(...args)\n    this._levels = []\n    this._pendingAdaptationEvent = false\n    this._isShakaReadyState = false\n  }\n\n  play () {\n    if (!this._player) {\n      this._setup()\n    }\n\n    if (!this.isReady) {\n      this.once(DashShakaPlayback.Events.SHAKA_READY, this.play)\n      return\n    }\n\n    this._stopped = false\n    this._src = this.el.src\n    super.play()\n  }\n\n  // skipping HTML5Video `_setupSrc` (on tag video)\n  _setupSrc () {}\n\n  // skipping ready event on video tag in favor of ready on shaka\n  _ready () {\n    // override with no-op\n  }\n\n  _onShakaReady() {\n    this._isShakaReadyState = true\n    this.trigger(DashShakaPlayback.Events.SHAKA_READY)\n    this.trigger(Events.PLAYBACK_READY, this.name)\n  }\n\n  get isReady () {\n    return this._isShakaReadyState\n  }\n\n  // skipping error handling on video tag in favor of error on shaka\n  error (event) {\n    Log.error('an error was raised by the video tag', event, this.el.error)\n  }\n\n  isHighDefinitionInUse () {\n    return !!this.highDefinition\n  }\n\n  stop () {\n    clearInterval(this.sendStatsId)\n    this._stopped = true\n\n    if (this._player) {\n      this._sendStats()\n\n      this._player.unload().then(() => {\n        super.stop()\n        this._player = null\n        this._isShakaReadyState = false\n      }).catch(() => {\n        Log.error('shaka could not be unloaded')\n      })\n    } else {\n      super.stop()\n    }\n  }\n\n  get textTracks () {\n    return this.isReady && this._player.getTextTracks()\n  }\n\n  get audioTracks () {\n    return this.isReady && this._player.getVariantTracks().filter((t) => t.mimeType.startsWith('audio/'))\n  }\n\n  get videoTracks () {\n    return this.isReady && this._player.getVariantTracks().filter((t) => t.mimeType.startsWith('video/'))\n  }\n\n  getPlaybackType () {\n    return (this.isReady && this._player.isLive() ? 'live' : 'vod') || ''\n  }\n\n  selectTrack (track) {\n    if (track.type === 'text') {\n        this._player.selectTextTrack(track)\n    } else if (track.type === 'variant') {\n        this._player.selectVariantTrack(track)\n        if (track.mimeType.startsWith('video/')) {\n            // we trigger the adaptation event here\n            // because Shaka doesn't trigger its event on \"manual\" selection.\n            this._onAdaptation()\n        }\n    } else {\n        throw new Error('Unhandled track type:', track.type);\n    }\n  }\n\n  /**\n   * @override\n   */\n  get closedCaptionsTracks() {\n    let id = 0\n    let trackId = () => { return id++ }\n    let tracks = this.textTracks || []\n\n    return tracks\n      .filter(track => track.kind === 'subtitle')\n      .map(track => { return {id: trackId(), name: track.label || track.language, track: track} })\n  }\n\n  /**\n   * @override\n   */\n  get closedCaptionsTrackId() {\n    return super.closedCaptionsTrackId\n  }\n\n  /**\n   * @override\n   */\n  set closedCaptionsTrackId(trackId) {\n    if (!this._player) {\n      return\n    }\n\n    let tracks = this.closedCaptionsTracks\n    let showingTrack\n\n    // Note: -1 is for hide all tracks\n    if (trackId !== -1) {\n      showingTrack = tracks.find(track => track.id === trackId)\n      if (!showingTrack) {\n        Log.warn(`Track id \"${trackId}\" not found`)\n        return\n      }\n      if (this._shakaTTVisible && showingTrack.track.active === true) {\n        Log.info(`Track id \"${trackId}\" already showing`)\n        return\n      }\n    }\n\n    if (showingTrack) {\n      this._player.selectTextTrack(showingTrack.track)\n      this._enableShakaTextTrack(true)\n    } else {\n      this._enableShakaTextTrack(false)\n    }\n\n    this._ccTrackId = trackId\n    this.trigger(Events.PLAYBACK_SUBTITLE_CHANGED, {\n      id: trackId\n    })\n  }\n\n  _enableShakaTextTrack(isEnable) {\n    // Shaka player use only one TextTrack object with video element to handle all text tracks\n    // It must be enabled or disabled in addition to call selectTextTrack()\n    if (!this.el.textTracks) {\n      return\n    }\n\n    this._shakaTTVisible = isEnable\n\n    Array.from(this.el.textTracks)\n      .filter(track => track.kind === 'subtitles')\n      .forEach(track => track.mode = isEnable === true ? 'showing' : 'hidden')\n  }\n\n  _checkForClosedCaptions() {\n    if (this._ccIsSetup) {\n      return\n    }\n\n    if (this.hasClosedCaptionsTracks) {\n      this.trigger(Events.PLAYBACK_SUBTITLE_AVAILABLE)\n      const trackId = this.closedCaptionsTrackId\n      this.closedCaptionsTrackId = trackId\n    }\n    this._ccIsSetup = true\n  }\n\n  destroy () {\n    clearInterval(this.sendStatsId)\n\n    if (this._player) {\n      this._player.destroy()\n        .then(() => this._destroy())\n        .catch(() => {\n          this._destroy()\n          Log.error('shaka could not be destroyed')\n        })\n    } else {\n      this._destroy()\n    }\n\n    super.destroy()\n  }\n\n  _setup () {\n    this._isShakaReadyState = false\n    this._ccIsSetup = false\n    this._player = this._createPlayer()\n    this._options.shakaConfiguration && this._player.configure(this._options.shakaConfiguration)\n    this._options.shakaOnBeforeLoad && this._options.shakaOnBeforeLoad(this._player)\n\n    let playerLoaded = this._player.load(this._options.src)\n    playerLoaded.then(() => this._loaded())\n      .catch((e) => this._setupError(e))\n  }\n\n  _createPlayer () {\n    let player = new shaka.Player(this.el)\n    player.addEventListener('error', this._onError.bind(this))\n    player.addEventListener('adaptation', this._onAdaptation.bind(this))\n    player.addEventListener('buffering', this._onBuffering.bind(this))\n    return player\n  }\n\n  _onBuffering (e) {\n    if (this._stopped) return\n    let event = e.buffering ? Events.PLAYBACK_BUFFERING : Events.PLAYBACK_BUFFERFULL\n    this.trigger(event)\n  }\n\n  _loaded () {\n    this._onShakaReady()\n    this._startToSendStats()\n    this._fillLevels()\n    this._checkForClosedCaptions()\n  }\n\n  _fillLevels () {\n    if (this._levels.length === 0) {\n      this._levels = this.videoTracks.map((videoTrack) => { return {id: videoTrack.id, label: `${videoTrack.height}p`} }).reverse()\n      this.trigger(Events.PLAYBACK_LEVELS_AVAILABLE, this.levels)\n    }\n  }\n\n  _startToSendStats () {\n    const intervalMs = this._options.shakaSendStatsInterval || SEND_STATS_INTERVAL_MS\n    this.sendStatsId = setInterval(() => this._sendStats(), intervalMs)\n  }\n\n  _sendStats () {\n    this.trigger(Events.PLAYBACK_STATS_ADD, this._player.getStats())\n  }\n\n  _setupError (err) {\n    this._onError(err)\n  }\n\n  _onError (err) {\n    const error = {\n      shakaError: err,\n      videoError: this.el.error\n    }\n\n    let { category, code, severity } = error.shakaError.detail || error.shakaError\n\n    if (error.videoError || !code && !category) return super._onError()\n\n    const isCritical = severity === shaka.util.Error.Severity.CRITICAL\n    const errorData = {\n      code: `${category}_${code}`,\n      description: `Category: ${category}, code: ${code}, severity: ${severity}`,\n      level: isCritical ? PlayerError.Levels.FATAL : PlayerError.Levels.WARN,\n      raw: err\n    }\n    const formattedError = this.createError(errorData)\n    Log.error('Shaka error event:', formattedError)\n    this.trigger(Events.PLAYBACK_ERROR, formattedError)\n  }\n\n\n  _onAdaptation () {\n    let activeVideo = this.videoTracks.filter((t) => t.active === true)[0]\n\n    this._fillLevels()\n\n    // update stats that may have changed before we trigger event\n    // so that user can rely on stats data when handling event\n    this._sendStats()\n\n    if (this._pendingAdaptationEvent_) {\n      this.trigger(Events.PLAYBACK_LEVEL_SWITCH_END)\n      this._pendingAdaptationEvent = false\n    }\n\n    Log.debug('an adaptation has happened:', activeVideo)\n    this.highDefinition = (activeVideo.height >= 720)\n    this.trigger(Events.PLAYBACK_HIGHDEFINITIONUPDATE, this.highDefinition)\n    this.trigger(Events.PLAYBACK_BITRATE, {\n      bandwidth: activeVideo.bandwidth,\n      width: activeVideo.width,\n      height: activeVideo.height,\n      level: activeVideo.id\n    })\n  }\n\n  _destroy () {\n    this._isShakaReadyState = false\n    Log.debug('shaka was destroyed')\n  }\n}\n\nexport default DashShakaPlayback\n\n\n\n// WEBPACK FOOTER //\n// ./src/clappr-dash-shaka-playback.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"amd\":\"clappr\",\"commonjs\":\"clappr\",\"commonjs2\":\"clappr\",\"root\":\"Clappr\"}\n// module id = 1\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shaka\"\n// module id = 2\n// module chunks = 0"],"sourceRoot":""}